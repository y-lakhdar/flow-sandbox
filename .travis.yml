language: node_js
notifications:
  email:
    on_success: change
    on_failure: always
node_js:
  - '8.9'
cache:
  directories:
    - node_modules
before_install:
  - npm install -g npm@5.6.0
script:
  - source read.version.sh
  - echo "$TRAVIS_TAG"
  - npm run minimize
after_success:
  - npm run zipForGitReleases
deploy:
  - provider: npm
    email: ylakhdar@coveo.com
    skip_cleanup: true
    api_key:
      secure:  iX65c7lt20bB3BqBudqrS0M3wPUQMm7f4tdkasdn7hlGFmdSRvhPFQTwYLas4H8S7yDzmplxFVwiNmQUDDecV7yii4PEnjWb4M4bgTD1EzlCTnSO7idpeJwVz+O9et4RGo8njqekCuymCLqoSh1XmGbd8hv+149WVxtB+Fa5yiGHQCMHbEYSoFRZlQCk8uJvwwP5JLpBgh4usb3KNKX+Vy2QtSlQ3yV2z+IiRsQav5DHV7dCh8aqSiujxGyP/t8XkgauT1+g4RfnP67q5D1XVDOkXtZ3xOyYw/grTIYqovsE4USu0Gyyi2t7KOuX7n2qGqLHwLNslfIcD4A65974GSzB7dpsjKNTJO/GvTZERF9C86zAHLRigb/1eRNO3ZFmzKq0FpaNnmV8V0fNPViwUf8wXYwh2b2zba25xDdW5afVGVuetYQ6xtvoOSphpNCUF4PUZnPye6Vvi/uvbDCl1zX+xVPEfedgIhK4hyegH8yr9F6JzxAZeLmWe9voYcdqLXxtYH3WHI2YIVnTQdqXVVgghenBWhBornij2j8wnN9x8vaSyJHbErZ46e78mBMu3Q5JTpOsOFqFzGYKaJ/kUNlXnYX7OwPdjg+fnjEhg8n4I0o/kK7BIGoO54O2wVv9BtH6LarrlnZswTsz2b+yXnT9RNqwjELfIEHdFtN+228=
    on:
      tags: true
      all_branches: true
  - provider: releases
    api_key:
      secure: tS1qdXHnJ/+3WTmFmGDdkiSvKVvARePVZ2Oe073EiGDt5NrKm/w/0btbLFy7VPbSCldlazltbdsdksfjc4skkESTspP1OgnFnZscd00UzPnkWP/CMeK/rRS87Yieqjt9c6XJDZmbfTnhfg0TgTD5E/K+kmchY2IvGZznE4xZHnzaNXhiwQD3zeqTsQDvWwYXCwf2jI0nP5GWm3jGJOzlUdaYiRQImS9573wwsWkKrB+CJxs77YvPjrm0Dfw8IB2XCa9IgisufxhE52yyRivVQOadk+hfhQwcbwAPJd1TNLTG7wkiMGyd93alnwR2kYgVh8UP+gIVcM37p4hmEApL5zu0vEZ5y9EPMQfO7/RHkwnt07/afm72nkbcTrP/eqDRoBA/63Qr6ARLeHfKwoYwDpwTmlb1YR0IvlxZxVXnpHs+ET4Nszdcr07wiLqpsQSQPAanJ/9NXtrZAbpGzV753AvDmICvVzcTnVEYIGJmYcpbmI5o7WeuqnctS2jRQUM5uL3Vfa/fl3AboBd+ZvhReEzKV8Vq7ZtFSEIPWS8KiXe3MzX8KX9S1mv/7RwjBT/eVP5wSx5BboaTXLEuvVg3/EziNhmtAZhYZNG7+uhFITenlR34wbCr7e5QO+rafTYVLWY3IsnRygaJKAJ9mvKypGhfulxVKxCruIh6er2KHR0=
    file:
      - flow-sandbox.zip
    file_glob: true
    skip_cleanup: true
    on:
      tags: true
      repo: y-lakhdar/flow-sandbox
      all_branches: true
branches:
  only:
    - master
    - develop
    - "/[0-9]+\\.[0-9]+\\.[0-9]+/"